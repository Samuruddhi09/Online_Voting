<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Users</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-10">

            <div class="card shadow">
                <!-- Header -->
                <div class="card-header bg-primary text-white text-center">
                    <h4>Admin – Manage Users</h4>
                </div>

                <!-- Body -->
                <div class="card-body">

                    <!-- Flash messages -->
                    {% with messages = get_flashed_messages() %}
                      {% if messages %}
                        {% for message in messages %}
                          <div class="alert alert-success">{{ message }}</div>
                        {% endfor %}
                      {% endif %}
                    {% endwith %}

                    <table class="table table-bordered table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Voter ID</th>
                                <th>Role</th>
                                <th style="width: 250px;">Actions</th>
                            </tr>
                        </thead>

                        <tbody>
                        {% for user in users %}
                            <tr>
                                <td>{{ user.full_name }}</td>
                                <td>{{ user.email }}</td>
                                <td>{{ user.voter_id }}</td>
                                <td>
                                    <span class="badge {% if user.role == 'admin' %}bg-warning{% else %}bg-success{% endif %}">
                                        {{ user.role }}
                                    </span>
                                </td>
                                <td>
                                    <!-- Delete user -->
                                    <form action="/admin/delete-user/{{ user.id }}" method="POST" class="d-inline">
                                        <button class="btn btn-danger btn-sm"
                                                onclick="return confirm('Are you sure you want to delete this user?')">
                                            Delete
                                        </button>
                                    </form>

                                    <!-- Update role -->
                                    <form action="/admin/update-role/{{ user.id }}" method="POST" class="d-inline ms-2">
                                        <select name="role" class="form-select form-select-sm d-inline w-auto">
                                            <option value="voter" {% if user.role == 'voter' %}selected{% endif %}>
                                                Voter
                                            </option>
                                            <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>
                                                Admin
                                            </option>
                                        </select>
                                        <button class="btn btn-warning btn-sm ms-1">
                                            Update
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>

                    <div class="mt-3">
                        <a href="/admin" class="btn btn-secondary btn-sm">← Back to Dashboard</a>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>

</body>
</html>
